<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="Form.css">
  <title>ุจุฑูุงูุฌ ุงุฎุชุฑุงู ุณูู ุงูุนูู - ุงููุฑุญูุฉ ุงูุซุงููุฉ</title>
</head>

<body>
  <div class="container">
    <div class="header">
      <h1>ุจุฑูุงูุฌ ุงุฎุชุฑุงู ุณูู ุงูุนูู</h1>
      <p>ุงููุฑุญูุฉ ุงูุซุงููุฉ</p>
    </div>

    <div class="progress-container">
      <div class="progress-text" id="progressText">1 / 3</div>
      <div class="progress-bar-wrapper">
        <div class="progress-bar-fill" id="progressBar"></div>
      </div>
    </div>

    <div class="form-container">
      <form id="mainForm">
        <!-- Page 1 -->
        <div class="form-page active" id="page1">
          
          <div class="form-group">
            <label>ุงูุงุณู <span class="required">*</span></label>
            <input type="text" name="name" required minlength="3" id="name">
            <div class="error-message" id="name-error"></div>
          </div>
          <div class="form-group">
      <label>ุงูุณู <span class="required">*</span></label>
      <input type="number" name="age" required min="18" max="60" id="age">
      <div class="error-message" id="age-error"></div>
    </div>

    <div class="form-group">
      <label>ุงูุฑูู ุงููููู <span class="required">*</span></label>
      <input type="text" name="nationalId" required pattern="[0-9]{14}" maxlength="14" id="nationalId">
      <div class="error-message" id="nationalId-error"></div>
    </div>

    <div class="form-group">
      <label>ุฑูู ุงูุชููููู ุงููุญููู <span class="required">*</span></label>
      <input type="text" name="phone" required pattern="^01[0125][0-9]{8}$" maxlength="11" id="phone">
      <div class="error-message" id="phone-error"></div>
    </div>

    <div class="form-group">
      <label>ุฑูู ุชูุงุตู ูุงุชุณ <span class="required">*</span></label>
      <input type="text" name="whatsapp" required pattern="^01[0125][0-9]{8}$" maxlength="11" id="whatsapp">
      <div class="error-message" id="whatsapp-error"></div>
    </div>

    <div class="form-group">
      <label>ุงูุฅูููู <span class="required">*</span></label>
      <input type="email" name="email" required>
      <div class="error-message" id="email-error"></div>
    </div>

    <div class="form-group">
      <label>ุงูููุน <span class="required">*</span></label>
      <div class="radio-group">
        <div class="radio-option">
          <input type="radio" name="gender" value="ุฐูุฑ" required id="male">
          <label for="male">ุฐูุฑ</label>
        </div>
        <div class="radio-option">
          <input type="radio" name="gender" value="ุฃูุซู" required id="female">
          <label for="female">ุฃูุซู</label>
        </div>
      </div>
      <div class="error-message" id="gender-error"></div>
    </div>

    <div class="form-group">
      <label>ุงููุญุงูุธุฉ <span class="required">*</span></label>
      <select name="governorate" required>
        <option value="">ุงุฎุชุฑ ุงููุญุงูุธุฉ</option>
        <option value="ุงููุงูุฑุฉ">ุงููุงูุฑุฉ</option>
        <option value="ุงูุฌูุฒุฉ">ุงูุฌูุฒุฉ</option>
        <option value="ุงูุฅุณููุฏุฑูุฉ">ุงูุฅุณููุฏุฑูุฉ</option>
        <option value="ุงูุฏููููุฉ">ุงูุฏููููุฉ</option>
        <option value="ุงูุจุญุฑ ุงูุฃุญูุฑ">ุงูุจุญุฑ ุงูุฃุญูุฑ</option>
        <option value="ุงูุจุญูุฑุฉ">ุงูุจุญูุฑุฉ</option>
        <option value="ุงููููู">ุงููููู</option>
        <option value="ุงูุบุฑุจูุฉ">ุงูุบุฑุจูุฉ</option>
        <option value="ุงูุฅุณูุงุนูููุฉ">ุงูุฅุณูุงุนูููุฉ</option>
        <option value="ุงููููููุฉ">ุงููููููุฉ</option>
        <option value="ุงููููุง">ุงููููุง</option>
        <option value="ุงูููููุจูุฉ">ุงูููููุจูุฉ</option>
        <option value="ุงููุงุฏู ุงูุฌุฏูุฏ">ุงููุงุฏู ุงูุฌุฏูุฏ</option>
        <option value="ุงูุณููุณ">ุงูุณููุณ</option>
        <option value="ุงุณูุงู">ุงุณูุงู</option>
        <option value="ุงุณููุท">ุงุณููุท</option>
        <option value="ุจูู ุณููู">ุจูู ุณููู</option>
        <option value="ุจูุฑุณุนูุฏ">ุจูุฑุณุนูุฏ</option>
        <option value="ุฏููุงุท">ุฏููุงุท</option>
        <option value="ุงูุดุฑููุฉ">ุงูุดุฑููุฉ</option>
        <option value="ุฌููุจ ุณููุงุก">ุฌููุจ ุณููุงุก</option>
        <option value="ููุฑ ุงูุดูุฎ">ููุฑ ุงูุดูุฎ</option>
        <option value="ูุทุฑูุญ">ูุทุฑูุญ</option>
        <option value="ุงูุฃูุตุฑ">ุงูุฃูุตุฑ</option>
        <option value="ููุง">ููุง</option>
        <option value="ุดูุงู ุณููุงุก">ุดูุงู ุณููุงุก</option>
        <option value="ุณููุงุฌ">ุณููุงุฌ</option>
      </select>
      <div class="error-message" id="governorate-error"></div>
    </div>

    <div class="form-group">
      <label>ุงูุนููุงู <span class="required">*</span></label>
      <textarea name="address" required rows="3"></textarea>
      <div class="error-message" id="address-error"></div>
    </div>
          <div class="button-group">
            <button type="button" class="btn-next" onclick="nextPage()">ุงูุชุงูู</button>
          </div>
        </div>

        
        <div class="form-page" id="page2">
          <div class="form-group">
      <label>ุงูุญุงูุฉ <span class="required">*</span></label>
      <div class="radio-group">
        <div class="radio-option">
          <input type="radio" name="studentStatus" value="ุทุงูุจ" required id="student">
          <label for="student">ุทุงูุจ</label>
        </div>
        <div class="radio-option">
          <input type="radio" name="studentStatus" value="ุฎุฑูุฌ" required id="graduate">
          <label for="graduate">ุฎุฑูุฌ</label>
        </div>
      </div>
      <div class="error-message" id="studentStatus-error"></div>
    </div>

    <div class="form-group">
      <label>ุงูุฌุงูุนุฉ <span class="required">*</span></label>
      <input type="text" name="university" required>
      <div class="error-message" id="university-error"></div>
    </div>

    <div class="form-group">
      <label>ุงููููุฉ <span class="required">*</span></label>
      <input type="text" name="faculty" required>
      <div class="error-message" id="faculty-error"></div>
    </div>

    <div class="form-group">
      <label>ุณูุฉ ุงูุชุฎุฑุฌ <span class="required">*</span></label>
      <input type="number" name="graduationYear" required min="2010" max="2035" id="graduationYear">
      <div class="error-message" id="graduationYear-error"></div>
    </div>

    <div class="form-group">
      <label>ูู ุญุถุฑุช ุงููุฑุญูุฉ ุงูุฃููู ูู ุงูุจุฑูุงูุฌุ <span class="required">*</span></label>
      <div class="radio-group">
        <div class="radio-option">
          <input type="radio"  name="phase1" value="ูุนู" required id="phase1Yes">
          <label for="phase1Yes">ูุนู</label>
        </div>
        <div class="radio-option">
          <input type="radio" name="phase1" value="ูุง" required id="phase1No">
          <label for="phase1No">ูุง</label>
        </div>
      </div>
      <div class="error-message" id="phase1-error"></div>
    </div>

    <div class="form-group">
      <label>ูู ุฃูุช ูู ูุณุชููุฏู ูุญุฏุงุช ุงูุชุถุงูู ุจุงูุฌุงูุนุงุชุ <span class="required">*</span></label>
      <div class="radio-group">
        <div class="radio-option">
          <input type="radio" name="solidarity" value="ูุนู" required id="solidarityYes">
          <label for="solidarityYes">ูุนู</label>
        </div>
        <div class="radio-option">
          <input type="radio" name="solidarity" value="ูุง" required id="solidarityNo">
          <label for="solidarityNo">ูุง</label>
        </div>
      </div>
      <div class="error-message" id="solidarity-error"></div>
    </div>

    <div class="form-group">
      <label>ูู ุฃูุช ูู ุฐูู ุงููููุ <span class="required">*</span></label>
      <div class="radio-group">
        <div class="radio-option">
          <input type="radio" name="specialNeeds" value="ูุนู" required id="specialNeedsYes">
          <label for="specialNeedsYes">ูุนู</label>
        </div>
        <div class="radio-option">
          <input type="radio" name="specialNeeds" value="ูุง" required id="specialNeedsNo">
          <label for="specialNeedsNo">ูุง</label>
        </div>
      </div>
      <div class="error-message" id="specialNeeds-error"></div>
    </div>

    <div class="form-group">
      <label>ูู ุฃูุช ูู ุทูุงุจ ุชูุงูู ู ูุฑุงููุ <span class="required">*</span></label>
      <div class="radio-group">
        <div class="radio-option">
          <input type="radio" name="Takafol" value="ูุนู" required id="TakafolYes">
          <label for="TakafolYes">ูุนู</label>
        </div>
        <div class="radio-option">
          <input type="radio" name="Takafol" value="ูุง" required id="TakafolNo">
          <label for="TakafolNo">ูุง</label>
        </div>
      </div>
      <div class="error-message" id="Takafol-error"></div>
    </div>

    <div class="form-group">
      <label>ูู ุชูุชูู ูุงุจุชูุจุ <span class="required">*</span></label>
      <div class="radio-group">
        <div class="radio-option">
          <input type="radio" name="hasLaptop" value="ูุนู" required id="laptopYes">
          <label for="laptopYes">ูุนู</label>
        </div>
        <div class="radio-option">
          <input type="radio" name="hasLaptop" value="ูุง" required id="laptopNo">
          <label for="laptopNo">ูุง</label>
        </div>
      </div>
      <div class="error-message" id="hasLaptop-error"></div>
    </div>
          <div class="button-group">
            <button type="button" class="btn-back" onclick="prevPage()">ุงูุณุงุจู</button>
            <button type="button" class="btn-next" onclick="nextPage()">ุงูุชุงูู</button>
          </div>
        </div>

        <!-- Page 3 -->
        <div class="form-page" id="page3">
           <div class="form-group">
      <label>ูุฌุงู ุงูุชุฏุฑูุจ (ุงุฎุชุฑ ูุงุญุฏ ููุท) <span class="required">*</span></label>
     <div class="training-select">
  <label class="training-option">
    <input type="radio" name="training" value="ุงูุชุณููู ุงูุฑููู - Digital Marketing" required>
    <span>ุงูุชุณููู ุงูุฑููู - Digital Marketing</span>
  </label>

  <label class="training-option">
    <input type="radio" name="training" value="ูุชุงุจุฉ ุงููุญุชูู - Content Writing" required>
    <span>ูุชุงุจุฉ ุงููุญุชูู - Content Writing</span>
  </label>

  <label class="training-option">
    <input type="radio" name="training" value="ุงูุชูููููุฌูุง ุงููุงููุฉ - Financial Technology" required>
    <span>ุงูุชูููููุฌูุง ุงููุงููุฉ - Financial Technology</span>
  </label>

  <label class="training-option">
    <input type="radio" name="training" value="ุงูุชุฌุงุฑุฉ ุงูุงููุชุฑูููุฉ - E-Commerce" required>
    <span>ุงูุชุฌุงุฑุฉ ุงูุงููุชุฑูููุฉ - E-Commerce</span>
  </label>

  <label class="training-option">
    <input type="radio" name="training" value="ุงูุชุฏุฑูุณ - Teaching (ุทูุงุจ ุขุฏุงุจ ูุชุฑุจูุฉ ููุท)" required>
    <span>ุงูุชุฏุฑูุณ - Teaching (ุทูุงุจ ุขุฏุงุจ ูุชุฑุจูุฉ ููุท)</span>
  </label>

  <label class="training-option">
    <input type="radio" name="training" value="ุงูููุงุฑุฏ ุงูุจุดุฑูุฉ - Human Resources" required>
    <span>ุงูููุงุฑุฏ ุงูุจุดุฑูุฉ - Human Resources</span>
  </label>

  <label class="training-option">
    <input type="radio" name="training" value="ุชุทููุฑ ุงูุฃุนูุงู ูุงููุจูุนุงุช - Business Development & Sales" required>
    <span>ุชุทููุฑ ุงูุฃุนูุงู ูุงููุจูุนุงุช - Business Development & Sales</span>
  </label>

  <label class="training-option">
    <input type="radio" name="training" value="ุงูุจุฑูุฌุฉ ูุงูุฐูุงุก ุงูุงุตุทูุงุนู - Programming & AI (ูุดุชุฑุท ุงูุชูุงู ูุงุจุชูุจ)" required>
    <span>ุงูุจุฑูุฌุฉ ูุงูุฐูุงุก ุงูุงุตุทูุงุนู - Programming & AI (ูุดุชุฑุท ุงูุชูุงู ูุงุจุชูุจ)</span>
  </label>
</div>

      <div class="error-message" id="training-error"></div>
    </div>

    <div class="form-group">
      <label>ูู ุชุนุฑู ุฃู ุดูุก ุนู ุงููุฌุงู ุงูุฐู ุงุฎุชุฑุชูุ</label>
      <textarea name="knowledge_about_field" rows="3" required placeholder="ุงูุชุจ ุจุฅูุฌุงุฒ ูุง ุชุนุฑูู ุนู ุงููุฌุงู..."></textarea>
    </div>

    <div class="form-group">
      <label>ููุงุฐุง ุงุฎุชุฑุช ูุฐุง ุงููุฌุงูุ</label>
      <textarea name="reason_for_choice" rows="3" required placeholder="ุงุฐูุฑ ุงูุณุจุจ ุงูุฐู ุฌุนูู ุชุฎุชุงุฑ ูุฐุง ุงููุฌุงู..."></textarea>
    </div>

    <div class="form-group">
      <label>ูุง ุงูุฐู ุชุชููุน ุฃู ุชุชุนููู ูู ูุฐุง ุงููุฌุงูุ</label>
      <textarea name="expectations_from_field" rows="3" required placeholder="ุงูุชุจ ูุง ุชุชููุน ุฃู ุชุชุนููู ุฃุซูุงุก ุงูุชุฏุฑูุจ..."></textarea>
    </div>


          <div class="form-group">
            <label>ุงูุณูุฑุฉ ุงูุฐุงุชูุฉ (CV) - ุงุฎุชูุงุฑู (ุตูุฑุฉ ููุท)</label>
            <div class="file-input-wrapper">
              <input type="file" name="cv" id="cv" accept="image/*">
              <label for="cv" class="file-input-label">ุงุถุบุท ูุงุฎุชูุงุฑ ุงูุตูุฑุฉ</label>
              <div class="file-name" id="cvName"></div>
            </div>
          </div>

          <div class="form-group">
            <label>ุตูุฑุฉ ุงูุจุทุงูุฉ <span class="required">*</span></label>
            <div class="file-input-wrapper">
              <input type="file" name="idCard" id="idCard" accept="image/*" required>
              <label for="idCard" class="file-input-label">ุงุถุบุท ูุงุฎุชูุงุฑ ุงูุตูุฑุฉ</label>
              <div class="file-name" id="idCardName"></div>
            </div>
            <div class="error-message" id="idCard-error"></div>
          </div>

          <div class="form-group">
            <label>ุตูุฑุฉ ุดุฎุตูุฉ <span class="required">*</span></label>
            <div class="file-input-wrapper">
              <input type="file" name="photo" id="photo" accept="image/*" required>
              <label for="photo" class="file-input-label">ุงุถุบุท ูุงุฎุชูุงุฑ ุงูุตูุฑุฉ</label>
              <div class="file-name" id="photoName"></div>
            </div>
            <div class="error-message" id="photo-error"></div>
          </div>

          <div class="button-group">
            <button type="button" class="btn-back" onclick="prevPage()">ุงูุณุงุจู</button>
            <button type="submit" class="btn-submit">ุฅุฑุณุงู</button>
          </div>
        </div>
      </form>

      <div class="success-message" id="successMessage">
        <div class="success-icon">โ</div>
        <h2 style="color: #092c27; margin-bottom: 15px;">ุชู ุฅุฑุณุงู ุงูุจูุงูุงุช ุจูุฌุงุญ!</h2>
        <p style="color: #708D81;">ุดูุฑุงู ูุชุณุฌููู ูู ุจุฑูุงูุฌ ุงุฎุชุฑุงู ุณูู ุงูุนูู</p>
      </div>
    </div>
  </div>

 
  <div class="loading-overlay" id="loadingOverlay">
    <div class="spinner"></div>
    <p>ุฌุงุฑู ุฑูุน ุงููููุงุช ูุฅุฑุณุงู ุงูุจูุงูุงุช...</p>
  </div>

  <script>
    let currentPage = 1;

    const validationRules = {
      name: { validate: v => v.length >= 3, message: 'ุงูุงุณู ูุฌุจ ุฃู ูููู 3 ุฃุญุฑู ุนูู ุงูุฃูู' },
      age: { validate: v => v >= 18 && v <= 60, message: 'ุงูุณู ูุฌุจ ุฃู ูููู ุจูู 18 ู60' },
      nationalId: { validate: v => /^[0-9]{14}$/.test(v), message: 'ุงูุฑูู ุงููููู ูุฌุจ ุฃู ูููู 14 ุฑูู' },
      phone: { validate: v => /^01[0125][0-9]{8}$/.test(v), message: 'ุฑูู ุงูุชููููู ุบูุฑ ุตุญูุญ' },
      whatsapp: { validate: v => /^01[0125][0-9]{8}$/.test(v), message: 'ุฑูู ุงููุงุชุณ ุบูุฑ ุตุญูุญ' },
      email: { validate: v => /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(v), message: 'ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ุบูุฑ ุตุญูุญ' },
      graduationYear: { validate: v => v >= 2010 && v <= 2030, message: 'ุณูุฉ ุงูุชุฎุฑุฌ ุจูู 2010 ู2030' }
    };

    function nextPage() {
      if (!validatePage(currentPage)) return;
      document.getElementById(`page${currentPage}`).classList.remove('active');
      currentPage++;
      document.getElementById(`page${currentPage}`).classList.add('active');
      updateProgress();
      window.scrollTo(0, 0);
    }

    function prevPage() {
      document.getElementById(`page${currentPage}`).classList.remove('active');
      currentPage--;
      document.getElementById(`page${currentPage}`).classList.add('active');
      updateProgress();
      window.scrollTo(0, 0);
    }

    function updateProgress() {
      document.getElementById('progressText').textContent = `${currentPage} / 3`;
      document.getElementById('progressBar').style.width = `${(currentPage / 3) * 100}%`;
    }

    function validatePage(pageNum) {
  const page = document.getElementById(`page${pageNum}`);
  const inputs = page.querySelectorAll('input[required], select[required], textarea[required]');
  let isValid = true;

  for (let input of inputs) {
    const fieldName = input.name;
    const rule = validationRules[fieldName];
    const errorDiv = document.getElementById(`${fieldName}-error`);

    // ๐น ุชุญูู ุฎุงุต ุจุฃุณุฆูุฉ ุงูุฑุงุฏูู (ูุนู / ูุง)
    if (input.type === 'radio') {
      const radios = page.querySelectorAll(`input[name="${fieldName}"]`);
      const checked = Array.from(radios).some(r => r.checked);
      if (!checked) {
        isValid = false;
        if (errorDiv) errorDiv.textContent = 'ุงูุฑุฌุงุก ุงุฎุชูุงุฑ ุฅุฌุงุจุฉ';
      } else {
        if (errorDiv) errorDiv.textContent = '';
      }
      continue;
    }

    // ๐น ุชุญูู ุงูุญููู ุงูุนุงุฏูุฉ
    if (!input.value || (rule && !rule.validate(input.value))) {
      input.classList.add('error');
      if (errorDiv) errorDiv.textContent = rule ? rule.message : 'ูุฐุง ุงูุญูู ูุทููุจ';
      isValid = false;
    } else {
      input.classList.remove('error');
      if (errorDiv) errorDiv.textContent = '';
    }
  }

  return isValid;
}

    document.getElementById('mainForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      
      if (!validatePage(currentPage)) return;

      const loading = document.getElementById('loadingOverlay');
      loading.classList.add('active');

      const formElements = new FormData(e.target);
      const data = {};
      for (let [key, value] of formElements.entries()) {
        if (!(value instanceof File)) data[key] = value;
      }

      const SERVER_URL = "https://formr2back-production.up.railway.app";

      try {
        const checkResp = await fetch(`${SERVER_URL}/check-nid`, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ nationalId: data.nationalId })
        });

        const checkResult = await checkResp.json();
        if (checkResult.exists) {
          loading.classList.remove('active');
          alert("ุงูุฑูู ุงููููู ูุณุฌู ุจุงููุนู โ ูุง ูููู ุงูุฅุฑุณุงู ูุฑุชูู.");
          return;
        }

        async function uploadToCloudinary(file) {
          const url = "https://api.cloudinary.com/v1_1/dhfjfi5nd/upload";
          const formData = new FormData();
          formData.append("file", file);
          formData.append("upload_preset", "unsigned_upload");
          const res = await fetch(url, { method: "POST", body: formData });
          const result = await res.json();
          if (result.error) throw new Error(result.error.message);
          return result.secure_url;
        }

        const cvFile = document.getElementById('cv').files[0];
        const idFile = document.getElementById('idCard').files[0];
        const photoFile = document.getElementById('photo').files[0];

        if (cvFile) data.cv = await uploadToCloudinary(cvFile);
        data.idCard = await uploadToCloudinary(idFile);
        data.photo = await uploadToCloudinary(photoFile);

        const res = await fetch(`${SERVER_URL}/submit`, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(data)
        });

        const result = await res.json();
        loading.classList.remove('active');

        if (result.status === "success") {
          document.querySelectorAll(".form-page").forEach(p => p.classList.remove("active"));
          document.getElementById("successMessage").classList.add("active");
        } else {
          alert("ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุงูุฅุฑุณุงู: " + result.message);
        }

      } catch (err) {
        loading.classList.remove('active');
        alert("ูุดู ุงูุงุชุตุงู ุจุงูุณูุฑูุฑ: " + err.message);
      }
    });
  </script>
</body>
</html>
